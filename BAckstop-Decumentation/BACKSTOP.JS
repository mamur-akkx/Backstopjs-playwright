/* 

ğŸ§  What is BackstopJS?
BackstopJS is a Visual Regression Testing tool.

It checks:

â€œDid the UI change visually after a code change?â€

Instead of checking code or text, it checks screenshots of pages.

It compares:

Old screenshot (baseline)

New screenshot (after change)

and shows:

What changed

Where it changed

By how much it changed

ğŸ–¼ï¸ What is Visual Regression Testing?

Imagine this:

Yesterday your login page looked like this
Today after a developer change, it looks slightly different

Even if functionality works, the UI might be broken:

Button moved

Text overlapped

Logo missing

Colors changed

Layout broken

BackstopJS catches this.

ğŸ§° What does BackstopJS use?

BackstopJS uses a browser engine to take screenshots:

Playwright

Puppeteer

Chrome Headless

It is NOT a test runner like Playwright
It is a visual comparison engine

ğŸ§± Core idea of BackstopJS

BackstopJS works in 4 simple steps

Step	What happens
1	Take baseline screenshots (good UI)
2	Save them
3	Take new screenshots (after change)
4	Compare both and show differences
ğŸ—‚ï¸ How BackstopJS is structured

BackstopJS uses a config file:

backstop.json


Inside it you define:

What pages to test

What screen size

What elements to capture

Example:

{
  "scenarios": [
    {
      "label": "Login Page",
      "url": "https://example.com/login",
      "selectors": ["document"]
    }
  ]
}


This means:

Take screenshot of the whole login page



ğŸ§ª How BackstopJS works in real life
Step 1 â€“ Create baseline

You run:

npx backstop reference


This stores:

â€œThis is how my app should lookâ€


Step 2 â€“ Run test after changes

You run:

npx backstop test


BackstopJS:

Takes new screenshots

Compares with baseline

Shows report

Step 3 â€“ See visual report

It opens a report showing:

Old image

New image

Difference highlighted in pink

This is the power of BackstopJS.

ğŸ” What BackstopJS detects

BackstopJS catches:

âœ… Layout shifts
âœ… Broken CSS
âœ… Missing buttons
âœ… Overlapping text
âœ… Font changes
âœ… Color changes
âœ… Responsive issues

It does NOT care about:

API

Clicks

Logic

Only visuals.



ğŸ§© BackstopJS vs Playwright
Playwright	BackstopJS
Checks functionality	Checks UI look
Clicks, typing	Takes screenshots
Asserts text	Compares images
Fails on logic	Fails on design

They are best when used together

ğŸ”¥ BackstopJS with Playwright

You can use Playwright to:

Login

Navigate

Prepare the page

Then BackstopJS:

Captures screenshots

Compares visuals

This gives you:

Full functional + visual coverage

ğŸ§  Real-world example

You change a CSS file.

Without BackstopJS:

Tests pass

But UI is broken

With BackstopJS:

Test fails

Shows â€œLogin button moved 50pxâ€

You catch the bug before users do.

ğŸ Final simple definition

BackstopJS is a tool that protects your websiteâ€™s design.

It makes sure:

â€œMy UI still looks the same after changes.â€

If you want, next I can show you
how to use BackstopJS with Playwright step-by-step ğŸš€

yes carry on

Perfect â€” letâ€™s continue and connect BackstopJS with Playwright step-by-step in a way you can actually use in real projects ğŸ”¥

ğŸ§© Goal

We want this flow:

Playwright logs in â†’ navigates â†’ BackstopJS takes screenshots â†’ BackstopJS compares visuals

This gives you real user flow + visual testing



ğŸ§± Step 1 â€“ Install BackstopJS
--------------------------------

Inside your Playwright project folder:

npm install --save-dev backstopjs


Then initialize it:
------------------

npx backstop init


This creates a folder:
---------------------

backstop_data/
backstop.json


This is Backstopâ€™s brain.

ğŸ§± Step 2 â€“ Tell Backstop to use Playwright

Open backstop.json

Find this:

"engine": "puppeteer"
Change it to:

"engine": "playwright"


This means:

â€œUse Playwright browser instead of Puppeteerâ€


ğŸ§± Step 3 â€“ Define what to test
-----------------------------

In backstop.json, find scenarios and edit:

"scenarios": [
  {
    "label": "Login Page",
    "url": "https://the-internet.herokuapp.com/login",
    "selectors": ["document"],
    "delay": 1000
  }
]


This means:

Take screenshot of the whole login page

ğŸ§± Step 4 â€“ Create baseline (first time)

Run:
npx backstop reference


This saves:
â€œThis is how the page should lookâ€

These images are stored in:

backstop_data/bitmaps_reference

ğŸ§± Step 5 â€“ Make a UI change (or simulate)

Now:

Change CSS

Or resize

Or let developer push new UI

Then run:

npx backstop test


Backstop will:

Take new screenshots

Compare with old ones

Open a report

You will see:
ğŸŸ¢ Green â†’ no change
ğŸ”´ Pink â†’ UI changed

ğŸ§  Now letâ€™s add Playwright login

Many apps need login before taking screenshot.

We create a Playwright script:

ğŸ“„ login.js
module.exports = async (page) => {
  await page.goto('https://the-internet.herokuapp.com/login');
  await page.fill('#username', 'tomsmith');
  await page.fill('#password', 'SuperSecretPassword!');
  await page.click('button[type="submit"]');
};

ğŸ§± Step 6 â€“ Tell Backstop to use this script

Edit backstop.json

Inside scenario:

"onBeforeScript": "login.js"


Full scenario:

{
  "label": "Secure Area",
  "url": "https://the-internet.herokuapp.com/secure",
  "onBeforeScript": "login.js",
  "selectors": ["#content"]
}


This means:

Before screenshot â†’ run login â†’ then capture page

ğŸ§± Step 7 â€“ Run Backstop again
npx backstop reference


Then later:

npx backstop test


Now you are visually testing a logged-in page.

ğŸ§  This is how big companies use it

Flow in CI:

Playwright logs in

Backstop takes screenshots

UI is compared

If UI breaks â†’ build fails

ğŸ Simple summary
Tool	            Job

Playwright        	Drive the browser
BackstopJS        	Compare screenshots
Both together   	Detect UI bugs automatically 

*/